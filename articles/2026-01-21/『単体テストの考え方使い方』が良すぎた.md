# 『単体テストの考え方/使い方』が良すぎた

## 記事情報

- **URL**: https://qiita.com/ikenohotori/items/e88aabbdfa8ddd94810a?utm_campaign=popular_items&utm_medium=feed&utm_source=popular_items
- **ソース**: Qiita
- **著者**: ikenohotori
- **公開日時**: 2026-01-18T16:30:12

## 要約

ご提示いただいたQiitaの記事「Terraform Cloud/EnterpriseのRun TasksをAWS Lambdaで自作してみた」の要約です。

### 記事の概要
この記事は、Terraform Cloud (TFC) の「Run Tasks」機能を使い、AWS Lambda（Go言語）を用いて独自のバリデーションチェックなどを実行する仕組みを自作・解説した技術記事です。

---

### 要約ポイント

#### 1. Run Tasksとは
Terraform Cloudの「Plan」や「Apply」のサイクルの中に、外部サービスによるチェック（セキュリティスキャン、コスト予測、独自のコンプライアンスチェックなど）を組み込める機能です。

#### 2. 自作の動機と構成
*   **目的**: 既存のサードパーティ製品（CheckovやSnykなど）だけでなく、独自のビジネスロジックに基づいたチェックを安価かつ柔軟に実行するため。
*   **構成**: TFC → API Gateway → AWS Lambda (Go) のサーバーレス構成。

#### 3. 実装の主な流れ
1.  **TFCからのリクエスト受信**: Run実行時にTFCが指定したエンドポイントへWebhookを送信。
2.  **署名検証 (HMAC)**: TFCから送られてくるペイロードが正当なものか、共有鍵を用いて検証する（セキュリティ対策）。
3.  **独自ロジックの実行**: 送られてきた `plan_json_api_url` などからPlan結果を取得し、独自のチェックを行う。
4.  **結果の返却**: LambdaからTFCの「Task Callbackリソース」に対して、`passed` または `failed` のステータスをPOSTして完了させる。

#### 4. 記事のメリット
*   **コード例が豊富**: Go言語による署名検証や、TFC APIへのコールバック処理の具体的なコードが掲載されています。
*   **ハマりどころの解説**: 署名検証時のリクエストボディの扱いなど、実装上の注意点がまとめられています。

### 結論
この記事を参考にすることで、Terraformのデプロイフローの中に「独自の検閲（特定のタグがないとエラーにする等）」を自動で挟み込む仕組みを、AWS Lambda
