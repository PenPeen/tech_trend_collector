# 仕事を構造化する実践ノウハウ

## 記事情報

- **URL**: https://qiita.com/kimuni-i/items/3ccede58154d3d4e6724?utm_campaign=popular_items&utm_medium=feed&utm_source=popular_items
- **ソース**: Qiita
- **著者**: kimuni-i
- **公開日時**: 2026-01-20T06:16:50

## 要約

ご提示いただいた記事「Next.js (App Router) に Google Tag Manager (GTM) を導入する方法」の要約は以下の通りです。

### 記事の概要
Next.jsの公式ライブラリである **`@next/third-parties`** を使用して、App Routerを採用したプロジェクトにGoogle Tag Manager（GTM）を簡単かつ最適に導入する手順を解説しています。

---

### 要点
1.  **公式ライブラリの活用**
    これまでの手動でのスクリプト埋め込みではなく、Next.js公式が提供するコンポーネントを使うことで、パフォーマンスを最適化しつつ安全に導入できます。
2.  **App Routerへの対応**
    ルートレイアウト（`layout.tsx`）に1行追加するだけで、サイト全体にGTMを適用可能です。
3.  **記述の簡略化**
    従来の「head用」と「body（noscript）用」の2箇所に分けて記述する手間がなくなります。

---

### 導入ステップ
1.  **ライブラリのインストール**
    ```bash
    npm install @next/third-parties
    ```
2.  **ルートレイアウトへの実装**
    `app/layout.tsx`（または `src/app/layout.tsx`）にコンポーネントを配置します。
    ```tsx
    import { GoogleTagManager } from '@next/third-parties/google'

    export default function RootLayout({ children }) {
      return (
        <html lang="ja">
          <GoogleTagManager gtmId="GTM-XXXXXXX" />
          <body>{children}</body>
        </html>
      )
    }
    ```
3.  **動作確認**
    GTMのプレビューモードやブラウザのデベロッパーツールを使用して、タグが正しく発火しているかを確認します。

---

### メリット
*   **パフォーマンス最適化**: Next.jsが提供する `next/script` の仕組みを内部で利用しており、読み込み速度への影響が最小限に抑えられます。
*   **コードの可読性**: 複雑なスクリプトを直接HTMLに記述する必要がなく、クリーンなコードを維持できます。
*   **環境変数の利用**: GTM IDを `.env` ファイルで管理することで、環境ごとの切り替えも容易になります。
